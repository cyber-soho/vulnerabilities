<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVSS v3.1 Interactive Learning Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .metric-card.active {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
        .severity-low { color: #22c55e; }
        .severity-medium { color: #eab308; }
        .severity-high { color: #f97316; }
        .severity-critical { color: #ef4444; }
        .bg-severity-low { background-color: #22c55e; }
        .bg-severity-medium { background-color: #eab308; }
        .bg-severity-high { background-color: #f97316; }
        .bg-severity-critical { background-color: #ef4444; }
        
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            margin-top: -4px;
        }
    </style>
    <!-- Chosen Palette: Warm Neutrals with Severity Semantic Colors (Slate, Blue, Green, Yellow, Orange, Red) -->
    <!-- Application Structure Plan: 
         1. Hero Section: Hook based on the "Chaos vs Order" problem.
         2. Triage Simulation: Interactive Pie Chart to visualize the "347 vulnerabilities" scenario. 
         3. The CVSS Framework: Interactive Scale & Metric Breakdown (Base, Temporal, Environmental).
         4. Live Calculator: A fully functional CVSS v3.1 Calculator with gauge visualization to teach how metrics affect score.
         5. Case Study Lab: Side-by-side comparison of Log4Shell vs Heartbleed using a Radar Chart.
         6. Workflow & Best Practices: Actionable takeaways.
         This structure moves from the "Why" (Problem) to the "What" (Framework) to "How" (Calculator) and finally "Application" (Case Studies).
    -->
    <!-- Visualization & Content Choices:
         1. Triage Pie Chart: Chart.js Doughnut. Goal: Show proportion of severity. Interaction: Click slice to see action required.
         2. Score Gauge: Chart.js Doughnut (Half). Goal: Real-time feedback on calculator.
         3. Case Study Radar: Chart.js Radar. Goal: Compare "shape" of vulnerabilities (Exploitability vs Impact).
         4. Metric Selector: HTML/JS Toggle Buttons. Goal: Allow exploring metric definitions without overwhelming text.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-slate-50 text-slate-800 font-sans leading-relaxed">

    <!-- Navigation -->
    <nav class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-xl font-bold text-slate-900 tracking-tight">CVSS<span class="text-blue-600">Hub</span></span>
                </div>
                <div class="hidden md:flex space-x-8 items-center">
                    <button onclick="scrollToSection('intro')" class="text-slate-500 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium">Overview</button>
                    <button onclick="scrollToSection('triage')" class="text-slate-500 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium">Triage</button>
                    <button onclick="scrollToSection('calculator')" class="text-slate-500 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium">Calculator</button>
                    <button onclick="scrollToSection('cases')" class="text-slate-500 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium">Case Studies</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div id="intro" class="bg-slate-900 text-white py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-4xl md:text-5xl font-extrabold mb-6">Common Vulnerability Scoring System</h1>
            <p class="text-xl text-slate-300 max-w-3xl mx-auto mb-8">
                Without a standard, security is chaos. CVSS transforms subjective opinions into objective, defensible numbers. 
                Learn how to prioritize the <span class="text-blue-400 font-bold">347 vulnerabilities</span> found today.
            </p>
            <div class="flex justify-center gap-4">
                <button onclick="scrollToSection('calculator')" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg transition-colors">
                    Try the Calculator
                </button>
                <button onclick="scrollToSection('triage')" class="bg-slate-700 hover:bg-slate-600 text-white font-bold py-3 px-8 rounded-lg transition-colors">
                    Start the Tour
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-20">

        <!-- Section: Triage Simulation -->
        <section id="triage" class="scroll-mt-20">
            <div class="mb-8 border-b border-slate-200 pb-4">
                <h2 class="text-3xl font-bold text-slate-900">Monday Morning Triage</h2>
                <p class="mt-4 text-lg text-slate-600">
                    Imagine your scanner finds 347 vulnerabilities. You can't fix them all at once. 
                    This interactive dashboard demonstrates how CVSS categories break down the chaos into actionable groups.
                    <span class="font-semibold text-blue-600">Click on the chart segments below to see the recommended action.</span>
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-100">
                    <h3 class="text-lg font-semibold text-slate-700 mb-4 text-center">Vulnerability Severity Distribution</h3>
                    <div class="chart-container">
                        <canvas id="triageChart"></canvas>
                    </div>
                </div>

                <div class="space-y-6">
                    <div id="triage-info" class="bg-blue-50 border-l-4 border-blue-500 p-6 rounded-r-lg">
                        <h3 id="triage-title" class="text-2xl font-bold text-blue-900 mb-2">Select a Category</h3>
                        <p id="triage-desc" class="text-slate-700 text-lg">Interact with the chart to see how to handle different severity levels based on CVSS scores.</p>
                        <div id="triage-action" class="mt-4 p-4 bg-white rounded shadow-sm hidden">
                            <span class="block text-sm font-semibold text-slate-500 uppercase tracking-wide">Recommended Action</span>
                            <p class="text-xl font-medium text-slate-900 mt-1">--</p>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                            <div class="text-sm text-slate-500">Total Vulns</div>
                            <div class="text-2xl font-bold text-slate-900">347</div>
                        </div>
                        <div class="p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                            <div class="text-sm text-slate-500">Critical Priority</div>
                            <div class="text-2xl font-bold text-red-600">~6.6%</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section: The Three Metric Groups -->
        <section id="metrics" class="scroll-mt-20">
            <div class="mb-8 border-b border-slate-200 pb-4">
                <h2 class="text-3xl font-bold text-slate-900">The Three Metric Groups</h2>
                <p class="mt-4 text-lg text-slate-600">
                    CVSS isn't just one number. It's a composite of three layers of context. 
                    Explore the cards below to understand the "DNA" of a vulnerability score.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
                <!-- Base -->
                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow border-t-4 border-blue-500 cursor-pointer" onclick="showMetricDetail('base')">
                    <h3 class="text-xl font-bold text-slate-900 mb-2">1. Base Metrics</h3>
                    <p class="text-sm text-slate-500 uppercase tracking-wide mb-4">Intrinsic & Constant</p>
                    <p class="text-slate-600">The foundation. Qualities inherent to the vulnerability that never change over time or environment.</p>
                    <ul class="mt-4 space-y-2 text-sm text-slate-700">
                        <li>&#8226; Attack Vector</li>
                        <li>&#8226; Attack Complexity</li>
                        <li>&#8226; Impact (CIA)</li>
                    </ul>
                </div>

                <!-- Temporal -->
                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow border-t-4 border-yellow-500 cursor-pointer" onclick="showMetricDetail('temporal')">
                    <h3 class="text-xl font-bold text-slate-900 mb-2">2. Temporal Metrics</h3>
                    <p class="text-sm text-slate-500 uppercase tracking-wide mb-4">Time-Dependent</p>
                    <p class="text-slate-600">Factors that evolve. Is there exploit code? Is there a patch? These change day-to-day.</p>
                     <ul class="mt-4 space-y-2 text-sm text-slate-700">
                        <li>&#8226; Exploit Code Maturity</li>
                        <li>&#8226; Remediation Level</li>
                        <li>&#8226; Report Confidence</li>
                    </ul>
                </div>

                <!-- Environmental -->
                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow border-t-4 border-green-500 cursor-pointer" onclick="showMetricDetail('environmental')">
                    <h3 class="text-xl font-bold text-slate-900 mb-2">3. Environmental Metrics</h3>
                    <p class="text-sm text-slate-500 uppercase tracking-wide mb-4">Your Context</p>
                    <p class="text-slate-600">The most critical layer. Adjusts the score based on YOUR specific organization's security requirements.</p>
                     <ul class="mt-4 space-y-2 text-sm text-slate-700">
                        <li>&#8226; Security Requirements (CIA)</li>
                        <li>&#8226; Modified Base Metrics</li>
                    </ul>
                </div>
            </div>

            <div id="metric-detail-panel" class="bg-slate-100 p-8 rounded-xl border border-slate-200">
                <h3 class="text-2xl font-bold text-slate-900 mb-4" id="detail-title">Select a Group Above</h3>
                <p class="text-slate-700" id="detail-content">Click on one of the three metric cards above to see a detailed breakdown of how they influence the final decision.</p>
            </div>
        </section>

        <!-- Section: Interactive Calculator -->
        <section id="calculator" class="scroll-mt-20">
            <div class="mb-8 border-b border-slate-200 pb-4">
                <h2 class="text-3xl font-bold text-slate-900">Live CVSS v3.1 Calculator</h2>
                <p class="mt-4 text-lg text-slate-600">
                    See the math in action. Adjust the Base Metrics below to see how Severity and Score change in real-time.
                    <br><span class="text-sm italic text-slate-500">Note: This is a simplified implementation for educational purposes. Always use the official FIRST.org calculator for compliance.</span>
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Calculator Controls -->
                <div class="lg:col-span-2 space-y-6 bg-white p-6 rounded-xl shadow-lg border border-slate-100">
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Exploitability Metrics -->
                        <div>
                            <h4 class="font-bold text-slate-900 mb-3 border-b pb-1">Exploitability Metrics</h4>
                            
                            <label class="block mb-3">
                                <span class="text-sm font-medium text-slate-700">Attack Vector (AV)</span>
                                <select id="av" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm bg-slate-50 p-2 border focus:ring-blue-500 focus:border-blue-500" onchange="calculateScore()">
                                    <option value="0.85">Network (N) [Worst]</option>
                                    <option value="0.62">Adjacent (A)</option>
                                    <option value="0.55">Local (L)</option>
                                    <option value="0.2">Physical (P) [Best]</option>
                                </select>
                            </label>

                            <label class="block mb-3">
                                <span class="text-sm font-medium text-slate-700">Attack Complexity (AC)</span>
                                <select id="ac" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm bg-slate-50 p-2 border focus:ring-blue-500 focus:border-blue-500" onchange="calculateScore()">
                                    <option value="0.77">Low (L) [Worst]</option>
                                    <option value="0.44">High (H) [Best]</option>
                                </select>
                            </label>

                            <label class="block mb-3">
                                <span class="text-sm font-medium text-slate-700">Privileges Required (PR)</span>
                                <select id="pr" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm bg-slate-50 p-2 border focus:ring-blue-500 focus:border-blue-500" onchange="calculateScore()">
                                    <option value="N">None (N) [Worst]</option>
                                    <option value="L">Low (L)</option>
                                    <option value="H">High (H) [Best]</option>
                                </select>
                            </label>

                            <label class="block mb-3">
                                <span class="text-sm font-medium text-slate-700">User Interaction (UI)</span>
                                <select id="ui" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm bg-slate-50 p-2 border focus:ring-blue-500 focus:border-blue-500" onchange="calculateScore()">
                                    <option value="0.85">None (N) [Worst]</option>
                                    <option value="0.62">Required (R) [Best]</option>
                                </select>
                            </label>
                        </div>

                        <!-- Impact Metrics -->
                        <div>
                            <h4 class="font-bold text-slate-900 mb-3 border-b pb-1">Impact Metrics</h4>
                            
                            <label class="block mb-3">
                                <span class="text-sm font-medium text-slate-700">Scope (S)</span>
                                <select id="s" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm bg-slate-50 p-2 border focus:ring-blue-500 focus:border-blue-500" onchange="calculateScore()">
                                    <option value="U">Unchanged (U)</option>
                                    <option value="C">Changed (C) [Worst]</option>
                                </select>
                            </label>

                            <label class="block mb-3">
                                <span class="text-sm font-medium text-slate-700">Confidentiality (C)</span>
                                <select id="c" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm bg-slate-50 p-2 border focus:ring-blue-500 focus:border-blue-500" onchange="calculateScore()">
                                    <option value="0.56">High (H) [Worst]</option>
                                    <option value="0.22">Low (L)</option>
                                    <option value="0">None (N) [Best]</option>
                                </select>
                            </label>

                            <label class="block mb-3">
                                <span class="text-sm font-medium text-slate-700">Integrity (I)</span>
                                <select id="i" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm bg-slate-50 p-2 border focus:ring-blue-500 focus:border-blue-500" onchange="calculateScore()">
                                    <option value="0.56">High (H) [Worst]</option>
                                    <option value="0.22">Low (L)</option>
                                    <option value="0">None (N) [Best]</option>
                                </select>
                            </label>

                            <label class="block mb-3">
                                <span class="text-sm font-medium text-slate-700">Availability (A)</span>
                                <select id="a" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm bg-slate-50 p-2 border focus:ring-blue-500 focus:border-blue-500" onchange="calculateScore()">
                                    <option value="0.56">High (H) [Worst]</option>
                                    <option value="0.22">Low (L)</option>
                                    <option value="0">None (N) [Best]</option>
                                </select>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Calculator Output -->
                <div class="bg-slate-900 text-white p-6 rounded-xl shadow-lg flex flex-col items-center justify-center relative">
                    <h3 class="text-xl font-medium text-slate-300 mb-4">Base Score</h3>
                    
                    <div class="chart-container" style="height: 200px;">
                        <canvas id="scoreGauge"></canvas>
                    </div>

                    <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center mt-6">
                        <span id="score-display" class="text-5xl font-extrabold block">0.0</span>
                    </div>

                    <div id="severity-badge" class="mt-4 px-4 py-1 rounded-full text-sm font-bold uppercase tracking-wider bg-slate-700 text-slate-300">
                        None
                    </div>

                    <div class="mt-6 w-full bg-slate-800 p-3 rounded text-xs font-mono break-all text-center text-slate-400">
                        <span id="vector-string">CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section: Case Studies -->
        <section id="cases" class="scroll-mt-20">
            <div class="mb-8 border-b border-slate-200 pb-4">
                <h2 class="text-3xl font-bold text-slate-900">Case Study: Log4Shell vs. Heartbleed</h2>
                <p class="mt-4 text-lg text-slate-600">
                    Why did Log4Shell get a perfect 10.0 while Heartbleed, despite its fame, only got a 7.5?
                    Compare the shapes of these vulnerabilities.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start">
                <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-100">
                    <div class="chart-container">
                        <canvas id="comparisonChart"></canvas>
                    </div>
                    <div class="mt-4 flex justify-center space-x-6 text-sm">
                        <div class="flex items-center"><span class="w-3 h-3 bg-red-500 rounded-full mr-2"></span>Log4Shell (10.0)</div>
                        <div class="flex items-center"><span class="w-3 h-3 bg-blue-500 rounded-full mr-2"></span>Heartbleed (7.5)</div>
                    </div>
                </div>

                <div class="space-y-6">
                    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                        <h3 class="font-bold text-red-900">Log4Shell (CVE-2021-44228)</h3>
                        <p class="text-sm text-red-800 mt-1">
                            <strong>Why 10.0?</strong> It hits the "Worst Case" on almost every metric.
                        </p>
                        <ul class="text-sm text-red-800 mt-2 list-disc list-inside">
                            <li><strong>Attack Vector:</strong> Network (Internet)</li>
                            <li><strong>Complexity:</strong> Low (Easy)</li>
                            <li><strong>Impact:</strong> Total compromise (Confidentiality, Integrity, Availability)</li>
                        </ul>
                    </div>

                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                        <h3 class="font-bold text-blue-900">Heartbleed (CVE-2014-0160)</h3>
                        <p class="text-sm text-blue-800 mt-1">
                            <strong>Why 7.5?</strong> It was critical, but limited in scope compared to Log4Shell.
                        </p>
                        <ul class="text-sm text-blue-800 mt-2 list-disc list-inside">
                            <li><strong>Attack Vector:</strong> Network</li>
                            <li><strong>Impact:</strong> High Confidentiality loss (passwords/keys stolen), but NO Integrity or Availability loss (server kept running, data wasn't deleted).</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section: Strategic Workflow -->
        <section id="strategy" class="bg-slate-900 text-white p-8 rounded-2xl my-16">
            <h2 class="text-2xl font-bold mb-6 text-center">Your Strategic Workflow</h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 text-center">
                <div class="bg-slate-800 p-4 rounded-lg">
                    <div class="text-3xl mb-2">üîç</div>
                    <h3 class="font-bold text-blue-400">1. Discovery</h3>
                    <p class="text-sm text-slate-400 mt-2">Assign Base Metrics. Intrinsic properties only.</p>
                </div>
                <div class="hidden md:block text-2xl text-slate-600 self-center">‚ûî</div>
                <div class="bg-slate-800 p-4 rounded-lg">
                    <div class="text-3xl mb-2">‚è±Ô∏è</div>
                    <h3 class="font-bold text-yellow-400">2. Temporal</h3>
                    <p class="text-sm text-slate-400 mt-2">Check exploit status. Is there a patch?</p>
                </div>
                <div class="hidden md:block text-2xl text-slate-600 self-center">‚ûî</div>
                <div class="bg-slate-800 p-4 rounded-lg">
                    <div class="text-3xl mb-2">üè¢</div>
                    <h3 class="font-bold text-green-400">3. Environmental</h3>
                    <p class="text-sm text-slate-400 mt-2">Apply your context. Critical asset? Test server?</p>
                </div>
                <div class="hidden md:block text-2xl text-slate-600 self-center">‚ûî</div>
                <div class="bg-slate-800 p-4 rounded-lg">
                    <div class="text-3xl mb-2">üõ°Ô∏è</div>
                    <h3 class="font-bold text-white">4. Decision</h3>
                    <p class="text-sm text-slate-400 mt-2">Prioritize based on Environmental Score.</p>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-slate-100 border-t border-slate-200 mt-12 py-8">
        <div class="max-w-7xl mx-auto px-4 text-center text-slate-500 text-sm">
            <p>&copy; 2026 Cyber.SoHo | Educational Material</p>
            <p class="mt-2">Remember: CVSS is guidance, not law. Always combine with threat intelligence.</p>
        </div>
    </footer>

    <!-- Logic Script -->
    <script>
        // --- Navigation ---
        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }

        // --- Metric Details Data ---
        const metricDetails = {
            base: {
                title: "Base Metrics: The Foundation",
                content: `
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-bold text-blue-800 mb-2">Exploitability</h4>
                            <ul class="list-disc list-inside text-sm space-y-1">
                                <li><strong>Attack Vector (AV):</strong> Can it be hacked from the internet (Network) or do you need physical access?</li>
                                <li><strong>Attack Complexity (AC):</strong> Is it easy (Low) or does it need perfect conditions (High)?</li>
                                <li><strong>Privileges Required (PR):</strong> Does the hacker need a login first?</li>
                                <li><strong>User Interaction (UI):</strong> Does the victim need to click a link?</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-bold text-blue-800 mb-2">Impact (Scope & CIA)</h4>
                            <ul class="list-disc list-inside text-sm space-y-1">
                                <li><strong>Scope (S):</strong> Does the hack spread to other systems (Changed)?</li>
                                <li><strong>Confidentiality (C):</strong> Is data stolen?</li>
                                <li><strong>Integrity (I):</strong> Is data altered?</li>
                                <li><strong>Availability (A):</strong> Is the system crashed?</li>
                            </ul>
                        </div>
                    </div>
                `
            },
            temporal: {
                title: "Temporal Metrics: The Clock is Ticking",
                content: `
                    <p class="mb-4">These metrics change over time. A vulnerability might start low-risk but become critical once a tool is released.</p>
                    <ul class="list-disc list-inside space-y-2 text-sm">
                        <li><strong>Exploit Code Maturity (E):</strong> Unproven -> PoC -> Functional -> High (Automated Tools). <span class="text-red-600 font-bold">This is the biggest driver of urgency.</span></li>
                        <li><strong>Remediation Level (RL):</strong> Is there an official patch? A workaround? Or nothing?</li>
                        <li><strong>Report Confidence (RC):</strong> Is this a confirmed bug or just a rumor?</li>
                    </ul>
                `
            },
            environmental: {
                title: "Environmental Metrics: Context is King",
                content: `
                    <p class="mb-4">This allows you to customize the score for YOUR specific assets.</p>
                    <div class="bg-white p-4 rounded border border-slate-200 text-sm">
                        <strong>Example:</strong> A SQL Injection (Base 8.8) on a:
                        <ul class="mt-2 space-y-1 ml-4 list-disc">
                            <li><span class="text-red-600 font-bold">Bank Database:</span> High Confidentiality Req -> Score jumps to <strong>9.2</strong></li>
                            <li><span class="text-green-600 font-bold">Internal Test Server:</span> Low Availability/Confidentiality Req -> Score drops to <strong>3.4</strong></li>
                        </ul>
                    </div>
                `
            }
        };

        function showMetricDetail(type) {
            const panel = document.getElementById('metric-detail-panel');
            const title = document.getElementById('detail-title');
            const content = document.getElementById('detail-content');
            
            title.innerHTML = metricDetails[type].title;
            content.innerHTML = metricDetails[type].content;
            
            // Highlight active card visual (simple implementation)
            document.querySelectorAll('.metric-card').forEach(el => el.classList.remove('active'));
        }

        // --- Chart 1: Triage Doughnut ---
        const ctxTriage = document.getElementById('triageChart').getContext('2d');
        const triageChart = new Chart(ctxTriage, {
            type: 'doughnut',
            data: {
                labels: ['Critical (9.0-10.0)', 'High (7.0-8.9)', 'Medium (4.0-6.9)', 'Low (0.1-3.9)'],
                datasets: [{
                    data: [23, 67, 156, 101], // Data from slide 5
                    backgroundColor: ['#ef4444', '#f97316', '#eab308', '#22c55e'],
                    borderWidth: 0,
                    hoverOffset: 10
                }]
            },
            options: {
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'bottom' }
                },
                onClick: (evt, activeElements) => {
                    if (activeElements.length > 0) {
                        const index = activeElements[0].index;
                        const labels = ['Critical', 'High', 'Medium', 'Low'];
                        const descriptions = [
                            "<strong>Patient with internal bleeding.</strong> Drop everything. Fix NOW. These vulnerabilities allow remote takeover with no skill.",
                            "<strong>Broken arm.</strong> Serious, but you might survive the weekend. Fix this week. Often requires some privileges or user interaction.",
                            "<strong>Headache.</strong> Annoying, but manageable. Fix this month. Limited impact or hard to execute.",
                            "<strong>Papercut.</strong> Fix when convenient (next maintenance window). Very low risk."
                        ];
                        const actions = ["Fix IMMEDIATELY (24hrs)", "Fix within 7 Days", "Fix within 30 Days", "Fix next quarter"];
                        
                        document.getElementById('triage-title').innerText = labels[index] + " Priority";
                        document.getElementById('triage-desc').innerHTML = descriptions[index];
                        document.getElementById('triage-action').classList.remove('hidden');
                        document.getElementById('triage-action').querySelector('p').innerText = actions[index];
                    }
                }
            }
        });

        // --- Chart 2: Calculator Gauge ---
        const ctxGauge = document.getElementById('scoreGauge').getContext('2d');
        const scoreGauge = new Chart(ctxGauge, {
            type: 'doughnut',
            data: {
                labels: ['Score', 'Remaining'],
                datasets: [{
                    data: [0, 10],
                    backgroundColor: ['#cbd5e1', '#f1f5f9'],
                    circumference: 180,
                    rotation: 270,
                    borderWidth: 0,
                    cutout: '80%'
                }]
            },
            options: {
                maintainAspectRatio: false,
                plugins: { legend: { display: false }, tooltip: { enabled: false } },
                animation: { duration: 500 }
            }
        });

        // --- Chart 3: Radar Comparison ---
        const ctxComparison = document.getElementById('comparisonChart').getContext('2d');
        const comparisonChart = new Chart(ctxComparison, {
            type: 'radar',
            data: {
                // Axis labels correspond to metrics. We map "Badness" 0-4.
                labels: ['Attack Vector (AV)', 'Complexity (AC)', 'Privileges (PR)', 'User Interaction (UI)', 'Confidentiality', 'Integrity', 'Availability'],
                datasets: [
                    {
                        label: 'Log4Shell (10.0)',
                        data: [4, 4, 4, 4, 4, 4, 4], // Max on everything (N, L, N, N, H, H, H)
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.2)',
                        borderWidth: 2
                    },
                    {
                        label: 'Heartbleed (7.5)',
                        data: [4, 4, 4, 4, 4, 0, 0], // Network, Low, None, None, High, None, None
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.2)',
                        borderWidth: 2
                    }
                ]
            },
            options: {
                maintainAspectRatio: false,
                scales: {
                    r: {
                        angleLines: { display: true },
                        suggestedMin: 0,
                        suggestedMax: 4,
                        ticks: { display: false } // Hide numbers to keep it abstract/visual
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                // Custom tooltip to explain the abstract numbers
                                return context.dataset.label;
                            }
                        }
                    }
                }
            }
        });

        // --- CVSS v3.1 Calculation Logic (Simplified) ---
        // This approximates the official math for educational purposes.
        
        function calculateScore() {
            // 1. Get Values
            const AV = parseFloat(document.getElementById('av').value);
            const AC = parseFloat(document.getElementById('ac').value);
            const PR_raw = document.getElementById('pr').value;
            const UI = parseFloat(document.getElementById('ui').value);
            const S = document.getElementById('s').value;
            const C = parseFloat(document.getElementById('c').value);
            const I = parseFloat(document.getElementById('i').value);
            const A = parseFloat(document.getElementById('a').value);

            // PR depends on Scope
            let PR = 0;
            if (S === 'U') {
                if (PR_raw === 'N') PR = 0.85;
                if (PR_raw === 'L') PR = 0.62;
                if (PR_raw === 'H') PR = 0.27;
            } else { // Scope Changed
                if (PR_raw === 'N') PR = 0.85;
                if (PR_raw === 'L') PR = 0.68;
                if (PR_raw === 'H') PR = 0.50;
            }

            // 2. Calculate ISS (Impact Sub Score)
            const ISS = 1 - ((1 - C) * (1 - I) * (1 - A));

            // 3. Calculate Impact
            let Impact = 0;
            if (S === 'U') {
                Impact = 6.42 * ISS;
            } else {
                Impact = 7.52 * (ISS - 0.029) - 3.25 * Math.pow((ISS - 0.02), 15);
            }

            // 4. Calculate Exploitability
            const Exploitability = 8.22 * AV * AC * PR * UI;

            // 5. Final Base Score
            let BaseScore = 0;
            if (Impact <= 0) {
                BaseScore = 0;
            } else {
                if (S === 'U') {
                    BaseScore = Math.min((Impact + Exploitability), 10);
                } else {
                    BaseScore = Math.min((1.08 * (Impact + Exploitability)), 10);
                }
            }

            // Round up to 1 decimal (Official CVSS rounding is complex, using standard ceil for simplicity here)
            BaseScore = Math.ceil(BaseScore * 10) / 10;
            if (BaseScore > 10) BaseScore = 10.0;

            // 6. Update UI
            updateCalculatorUI(BaseScore, {AV, AC, PR_raw, UI, S, C, I, A});
        }

        function updateCalculatorUI(score, params) {
            const display = document.getElementById('score-display');
            const badge = document.getElementById('severity-badge');
            const vector = document.getElementById('vector-string');
            
            // Update Number
            display.innerText = score.toFixed(1);

            // Update Gauge
            let color = '#cbd5e1';
            let label = 'None';
            
            if (score === 0) { color = '#94a3b8'; label = 'None'; }
            else if (score < 4.0) { color = '#22c55e'; label = 'Low'; }
            else if (score < 7.0) { color = '#eab308'; label = 'Medium'; }
            else if (score < 9.0) { color = '#f97316'; label = 'High'; }
            else { color = '#ef4444'; label = 'Critical'; }

            scoreGauge.data.datasets[0].data = [score, 10 - score];
            scoreGauge.data.datasets[0].backgroundColor = [color, '#f1f5f9'];
            scoreGauge.update();

            // Update Badge
            badge.innerText = label;
            badge.className = `mt-4 px-4 py-1 rounded-full text-sm font-bold uppercase tracking-wider text-white`;
            badge.style.backgroundColor = color;

            // Update Vector String
            const avStr = document.getElementById('av').options[document.getElementById('av').selectedIndex].text.match(/\(([^)]+)\)/)[1];
            const acStr = document.getElementById('ac').options[document.getElementById('ac').selectedIndex].text.match(/\(([^)]+)\)/)[1];
            const uiStr = document.getElementById('ui').options[document.getElementById('ui').selectedIndex].text.match(/\(([^)]+)\)/)[1];
            
            // Simple mapping for demo string
            let cStr = 'N'; if(params.C > 0.5) cStr='H'; else if(params.C > 0.1) cStr='L';
            let iStr = 'N'; if(params.I > 0.5) iStr='H'; else if(params.I > 0.1) iStr='L';
            let aStr = 'N'; if(params.A > 0.5) aStr='H'; else if(params.A > 0.1) aStr='L';

            vector.innerText = `CVSS:3.1/AV:${avStr}/AC:${acStr}/PR:${params.PR_raw}/UI:${uiStr}/S:${params.S}/C:${cStr}/I:${iStr}/A:${aStr}`;
        }

        // Initialize Calculator
        calculateScore();

    </script>
</body>
</html>





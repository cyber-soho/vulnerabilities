<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vulnerability Assessment Interactive Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Custom Chart Container Styles as per requirements */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        
        /* Custom Scrollbar for better UX in overflow areas */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f5f5f4; 
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #d6d3d1; 
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #a8a29e; 
        }

        /* Network Map Connector Lines (CSS only) */
        .network-connector {
            position: absolute;
            background-color: #d6d3d1;
            z-index: 0;
        }
        .network-line-vertical {
            width: 2px;
            height: 100%;
            left: 50%;
            transform: translateX(-50%);
        }
        .network-line-horizontal {
            height: 2px;
            width: 100%;
            top: 50%;
            transform: translateY(-50%);
        }
    </style>
    <!-- Chosen Palette: Warm Neutrals (Stone) with Amber/Orange Accents for 'Warning/Security' vibe -->
    <!-- Application Structure Plan: 
         The app is divided into 4 main interactive tabs (Dashboard View):
         1. "Profile Builder": Focuses on the 'What' (Building blocks, Ports, Credentials). 
            - Interaction: Clickable cards for definitions, Interactive Charts for Port/Credential comparisons.
         2. "Sensitivity & Zones": Focuses on the 'Where' and 'How'.
            - Interaction: Interactive Network Map. Clicking a zone (DMZ, LAN, etc.) reveals specific scan profiles. A slider demonstrates the Sensitivity Spectrum trade-offs.
         3. "Risk Calculator": A functional tool implementing the provided formula.
            - Interaction: Sliders/Inputs for risk factors, dynamic calculation of Risk Score and Recommended Sensitivity.
         4. "Reference": Glossary and Links.
            - Interaction: Searchable table.
         Rationale: The report moves from definitions to strategy to calculation. This structure allows the user to 'learn' the components, 'apply' them to a map, and then 'calculate' specific risks, promoting active synthesis.
    -->
    <!-- Visualization & Content Choices:
         1. Port Strategy: Bar Chart (Chart.js). Goal: Compare scale of checks (100 vs 65k). Interaction: None (static comparison). Justification: Magnitude difference is best shown via bars.
         2. Credentialed vs Non-Credentialed: Bar Chart. Goal: Show efficacy gap. Interaction: Toggle to reveal data.
         3. Sensitivity Spectrum: HTML Range Slider + Dynamic Text. Goal: Show trade-offs (False Pos/Neg). Interaction: Slider changes text. Justification: Linear spectrum maps perfectly to a slider.
         4. Network Map: CSS Grid Layout (No SVG). Goal: Visualize distributed scanning. Interaction: Click zones to see specific profiles. Justification: Boxes and lines can be built with pure HTML/CSS.
         5. Risk Score: JS Calculator. Goal: Operationalize Slide 19. Interaction: Inputs -> Result.
         6. Throttling: Bar Chart. Goal: Compare packets/sec.
         CONFIRMATION: NO SVG graphics used. NO Mermaid JS used.
    -->
</head>
<body class="bg-stone-50 text-stone-800 font-sans antialiased selection:bg-amber-200 selection:text-stone-900">

    <!-- Main App Container -->
    <div id="app" class="min-h-screen flex flex-col max-w-7xl mx-auto shadow-xl bg-white my-4 rounded-xl overflow-hidden border border-stone-200">

        <!-- Header -->
        <header class="bg-stone-900 text-stone-50 p-6 shadow-md relative z-10">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
                <div>
                    <h1 class="text-2xl md:text-3xl font-bold tracking-tight text-amber-500">ScanArchitect <span class="text-stone-400 font-light text-xl">| Vulnerability Assessment Hub</span></h1>
                    <p class="mt-2 text-stone-300 text-sm max-w-2xl">
                        A vulnerability assessment is a health check-up for a network. Use this interactive tool to configure the right examination for the right patient. Based on "Managing Vulnerabilities - Day 11".
                    </p>
                </div>
                <div class="mt-4 md:mt-0 text-right">
                    <div class="text-xs text-stone-400 uppercase tracking-wider">Current Module</div>
                    <div class="font-semibold text-amber-100">Configuring Profiles & Segments</div>
                </div>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="bg-stone-100 border-b border-stone-200 flex flex-wrap" aria-label="Tabs">
            <button onclick="switchTab('profile')" id="tab-btn-profile" class="tab-btn flex-1 py-4 px-6 text-center font-medium text-sm focus:outline-none hover:bg-stone-50 transition-colors border-b-2 border-amber-500 text-amber-700 bg-white">
                1. Build Scan Profile
            </button>
            <button onclick="switchTab('segments')" id="tab-btn-segments" class="tab-btn flex-1 py-4 px-6 text-center font-medium text-sm focus:outline-none hover:bg-stone-50 transition-colors border-b-2 border-transparent text-stone-500 hover:text-stone-700">
                2. Sensitivity & Segments
            </button>
            <button onclick="switchTab('calculator')" id="tab-btn-calculator" class="tab-btn flex-1 py-4 px-6 text-center font-medium text-sm focus:outline-none hover:bg-stone-50 transition-colors border-b-2 border-transparent text-stone-500 hover:text-stone-700">
                3. Risk Calculator
            </button>
            <button onclick="switchTab('glossary')" id="tab-btn-glossary" class="tab-btn flex-1 py-4 px-6 text-center font-medium text-sm focus:outline-none hover:bg-stone-50 transition-colors border-b-2 border-transparent text-stone-500 hover:text-stone-700">
                4. Glossary & Data
            </button>
        </nav>

        <!-- Main Content Area -->
        <main class="flex-grow p-6 md:p-8 bg-stone-50 overflow-y-auto custom-scrollbar relative">

            <!-- TAB 1: BUILD SCAN PROFILE -->
            <section id="tab-profile" class="tab-content space-y-8 animate-fade-in">
                <div class="max-w-4xl mx-auto text-center mb-8">
                    <h2 class="text-2xl font-bold text-stone-800 mb-3">Configuring the Scan Profile</h2>
                    <p class="text-stone-600 leading-relaxed">
                        A scan profile acts as a saved configuration template that instructs the scanner on <strong>what</strong> to look for, <strong>where</strong> to look, and <strong>how</strong> to look. Just as a doctor wouldn't order every medical test for a sore throat, security professionals must tune their profiles for precision and efficiency. Explore the building blocks below.
                    </p>
                </div>

                <!-- 6 Building Blocks Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-12">
                    <!-- Cards populated by JS -->
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-stone-200 hover:border-amber-400 cursor-pointer transition-all group" onclick="showBlockInfo(0)">
                        <div class="flex items-center mb-2">
                            <span class="bg-stone-100 text-stone-600 font-bold py-1 px-3 rounded text-xs mr-3 group-hover:bg-amber-100 group-hover:text-amber-700">1</span>
                            <h3 class="font-bold text-stone-800">Target Scope</h3>
                        </div>
                        <p class="text-sm text-stone-500">Defining IPs, Ranges, or Hostnames.</p>
                    </div>
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-stone-200 hover:border-amber-400 cursor-pointer transition-all group" onclick="showBlockInfo(1)">
                        <div class="flex items-center mb-2">
                            <span class="bg-stone-100 text-stone-600 font-bold py-1 px-3 rounded text-xs mr-3 group-hover:bg-amber-100 group-hover:text-amber-700">2</span>
                            <h3 class="font-bold text-stone-800">Port Range</h3>
                        </div>
                        <p class="text-sm text-stone-500">How many doors do we check?</p>
                    </div>
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-stone-200 hover:border-amber-400 cursor-pointer transition-all group" onclick="showBlockInfo(2)">
                        <div class="flex items-center mb-2">
                            <span class="bg-stone-100 text-stone-600 font-bold py-1 px-3 rounded text-xs mr-3 group-hover:bg-amber-100 group-hover:text-amber-700">3</span>
                            <h3 class="font-bold text-stone-800">Vuln Checks</h3>
                        </div>
                        <p class="text-sm text-stone-500">Plugins and specific tests.</p>
                    </div>
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-stone-200 hover:border-amber-400 cursor-pointer transition-all group" onclick="showBlockInfo(3)">
                        <div class="flex items-center mb-2">
                            <span class="bg-stone-100 text-stone-600 font-bold py-1 px-3 rounded text-xs mr-3 group-hover:bg-amber-100 group-hover:text-amber-700">4</span>
                            <h3 class="font-bold text-stone-800">Credentials</h3>
                        </div>
                        <p class="text-sm text-stone-500">Authenticated vs. Unauthenticated.</p>
                    </div>
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-stone-200 hover:border-amber-400 cursor-pointer transition-all group" onclick="showBlockInfo(4)">
                        <div class="flex items-center mb-2">
                            <span class="bg-stone-100 text-stone-600 font-bold py-1 px-3 rounded text-xs mr-3 group-hover:bg-amber-100 group-hover:text-amber-700">5</span>
                            <h3 class="font-bold text-stone-800">Throttling</h3>
                        </div>
                        <p class="text-sm text-stone-500">Speed and aggressiveness.</p>
                    </div>
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-stone-200 hover:border-amber-400 cursor-pointer transition-all group" onclick="showBlockInfo(5)">
                        <div class="flex items-center mb-2">
                            <span class="bg-stone-100 text-stone-600 font-bold py-1 px-3 rounded text-xs mr-3 group-hover:bg-amber-100 group-hover:text-amber-700">6</span>
                            <h3 class="font-bold text-stone-800">Compliance</h3>
                        </div>
                        <p class="text-sm text-stone-500">PCI DSS, NIST, CIS benchmarks.</p>
                    </div>
                </div>

                <!-- Dynamic Info Panel for Blocks -->
                <div id="block-detail-panel" class="bg-amber-50 border-l-4 border-amber-500 p-6 rounded-r-lg mb-12 hidden">
                    <h3 id="block-title" class="text-xl font-bold text-amber-900 mb-2">Title</h3>
                    <p id="block-desc" class="text-amber-800 mb-4">Description</p>
                    <div id="block-extra" class="text-sm text-amber-800 italic"></div>
                </div>

                <!-- Analysis Charts Grid -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    
                    <!-- Port Strategy Chart -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                        <h3 class="text-lg font-bold text-stone-800 mb-4 border-b pb-2">Port Selection Strategies</h3>
                        <p class="text-sm text-stone-500 mb-4">Comparison of ports scanned per strategy. "Full" covers all TCP ports (65,535).</p>
                        <div class="chart-container">
                            <canvas id="portChart"></canvas>
                        </div>
                        <div class="mt-4 text-xs text-stone-500 bg-stone-100 p-2 rounded">
                            <strong>Rule of Thumb:</strong> Internet-facing → Full scan. Internal → Top 1000.
                        </div>
                    </div>

                    <!-- Credentialed vs Non-Credentialed -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                        <h3 class="text-lg font-bold text-stone-800 mb-4 border-b pb-2">Credentialed vs. Non-Credentialed</h3>
                        <div class="flex justify-between items-center mb-4">
                            <p class="text-sm text-stone-500">Toggle to see the impact on findings.</p>
                            <button id="toggle-creds-btn" onclick="toggleCredChart()" class="bg-stone-200 hover:bg-stone-300 text-stone-700 px-3 py-1 rounded text-sm font-medium transition-colors">
                                Switch View
                            </button>
                        </div>
                        <div class="chart-container">
                            <canvas id="credChart"></canvas>
                        </div>
                        <div class="mt-4 text-xs text-stone-500 bg-stone-100 p-2 rounded">
                            <strong>Insight:</strong> Credentialed scans find 5–50× more vulnerabilities by reading configs and registries.
                        </div>
                    </div>

                </div>
            </section>

            <!-- TAB 2: SENSITIVITY & SEGMENTS -->
            <section id="tab-segments" class="tab-content hidden space-y-8 animate-fade-in">
                <div class="max-w-4xl mx-auto text-center mb-6">
                    <h2 class="text-2xl font-bold text-stone-800 mb-3">Targeting the Right Zone</h2>
                    <p class="text-stone-600 leading-relaxed">
                        Modern networks are segmented. A single scanner cannot see everything due to firewalls. We use <strong>Distributed Scanning</strong> (placing sensors inside segments) and tune <strong>Sensitivity</strong> based on the environment's fragility and risk.
                    </p>
                </div>

                <!-- Sensitivity Slider Interactive -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200 mb-8">
                    <h3 class="text-lg font-bold text-stone-800 mb-4">The Sensitivity Spectrum</h3>
                    <div class="relative pt-6 pb-2">
                        <input type="range" min="1" max="3" value="2" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-amber-600" id="sensitivity-slider" oninput="updateSensitivityUI()">
                        <div class="flex justify-between text-xs text-stone-500 mt-2 font-mono">
                            <span>LOW (Fragile)</span>
                            <span>SWEET SPOT</span>
                            <span>HIGH (Paranoid)</span>
                        </div>
                    </div>
                    <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                        <div class="p-3 rounded bg-stone-50 border border-stone-100 transition-colors" id="sens-findings">
                            <div class="text-xs uppercase text-stone-400 font-bold">Findings</div>
                            <div class="font-bold text-stone-800 text-lg" id="val-findings">Balanced</div>
                        </div>
                        <div class="p-3 rounded bg-stone-50 border border-stone-100 transition-colors" id="sens-fp">
                            <div class="text-xs uppercase text-stone-400 font-bold">False Positives</div>
                            <div class="font-bold text-stone-800 text-lg" id="val-fp">Manageable</div>
                        </div>
                        <div class="p-3 rounded bg-stone-50 border border-stone-100 transition-colors" id="sens-impact">
                            <div class="text-xs uppercase text-stone-400 font-bold">Network Impact</div>
                            <div class="font-bold text-stone-800 text-lg" id="val-impact">Moderate</div>
                        </div>
                    </div>
                    <p class="mt-4 text-sm text-center text-stone-600 italic" id="sens-desc">
                        The "Sweet Spot" catches genuine dangers without paralyzing operations.
                    </p>
                </div>

                <!-- Network Map & Info Split View -->
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
                    
                    <!-- Left: Interactive Map -->
                    <div class="lg:col-span-7 bg-stone-100 p-6 rounded-xl border border-stone-200 relative overflow-hidden min-h-[400px]">
                        <div class="absolute top-2 left-2 text-xs font-mono text-stone-400">INTERACTIVE TOPOLOGY MAP</div>
                        
                        <!-- Central Console -->
                        <div class="flex justify-center mb-8 relative z-10">
                            <div class="bg-stone-800 text-white p-4 rounded shadow-lg text-center w-48 border-2 border-stone-600">
                                <div class="font-bold text-sm">Central Console</div>
                                <div class="text-xs text-stone-400">Collects All Results</div>
                            </div>
                        </div>

                        <!-- Connector Lines (Visual Only) -->
                        <div class="absolute top-[80px] left-1/2 w-0.5 h-[60px] bg-stone-300 -translate-x-1/2"></div>
                        <div class="absolute top-[140px] left-[16%] right-[16%] h-0.5 bg-stone-300 border-t border-stone-300"></div>
                        <div class="absolute top-[140px] left-[16%] w-0.5 h-[30px] bg-stone-300"></div>
                        <div class="absolute top-[140px] right-[16%] w-0.5 h-[30px] bg-stone-300"></div>
                        <div class="absolute top-[140px] left-1/2 w-0.5 h-[30px] bg-stone-300"></div>

                        <!-- Zones Row 1 -->
                        <div class="grid grid-cols-3 gap-2 relative z-10 mt-8">
                            <button onclick="selectZone('dmz')" class="bg-white p-3 rounded shadow hover:shadow-md border-b-4 border-red-500 text-left transition-all hover:-translate-y-1 focus:ring-2 ring-red-300">
                                <div class="text-xs font-bold text-stone-400 mb-1">DMZ</div>
                                <div class="font-bold text-stone-800 text-sm">Public Servers</div>
                                <div class="text-[10px] text-stone-500 mt-2">Sensor A</div>
                            </button>
                            <button onclick="selectZone('lan')" class="bg-white p-3 rounded shadow hover:shadow-md border-b-4 border-blue-500 text-left transition-all hover:-translate-y-1 focus:ring-2 ring-blue-300">
                                <div class="text-xs font-bold text-stone-400 mb-1">CORP LAN</div>
                                <div class="font-bold text-stone-800 text-sm">Workstations</div>
                                <div class="text-[10px] text-stone-500 mt-2">Sensor B</div>
                            </button>
                            <button onclick="selectZone('server')" class="bg-white p-3 rounded shadow hover:shadow-md border-b-4 border-amber-500 text-left transition-all hover:-translate-y-1 focus:ring-2 ring-amber-300">
                                <div class="text-xs font-bold text-stone-400 mb-1">VLAN</div>
                                <div class="font-bold text-stone-800 text-sm">Databases</div>
                                <div class="text-[10px] text-stone-500 mt-2">Sensor C</div>
                            </button>
                        </div>

                        <!-- Zones Row 2 (OT) -->
                        <div class="flex justify-center mt-6 relative z-10">
                             <div class="absolute top-[165px] left-1/2 w-0.5 h-[130px] bg-stone-300 -translate-x-1/2 -z-10"></div>
                             <div class="absolute top-[295px] left-[50%] right-[30%] w-[100px] h-0.5 bg-stone-300"></div>
                             
                             <button onclick="selectZone('ot')" class="bg-white p-3 rounded shadow hover:shadow-md border-b-4 border-green-500 text-left w-48 transition-all hover:-translate-y-1 focus:ring-2 ring-green-300 ml-32">
                                <div class="text-xs font-bold text-stone-400 mb-1">OT / SCADA</div>
                                <div class="font-bold text-stone-800 text-sm">Industrial Control</div>
                                <div class="text-[10px] text-stone-500 mt-2">Sensor D (Passive)</div>
                            </button>
                        </div>
                        
                        <div class="mt-8 text-center text-xs text-stone-500">
                            Click a network zone above to see its configured Profile Strategy.
                        </div>
                    </div>

                    <!-- Right: Info Panel -->
                    <div class="lg:col-span-5">
                        <div id="zone-info-card" class="bg-white border border-stone-200 rounded-xl p-6 h-full shadow-sm flex flex-col justify-center text-center">
                            <div class="text-stone-300 mb-4">
                                <svg class="w-16 h-16 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                            </div>
                            <h3 class="text-xl font-bold text-stone-400">Select a Zone</h3>
                            <p class="text-stone-500 mt-2">Select a network segment on the map to view its specific scanning profile, sensitivity requirements, and rationales.</p>
                        </div>
                    </div>

                </div>
            </section>

            <!-- TAB 3: RISK CALCULATOR -->
            <section id="tab-calculator" class="tab-content hidden space-y-8 animate-fade-in">
                <div class="max-w-4xl mx-auto text-center mb-8">
                    <h2 class="text-2xl font-bold text-stone-800 mb-3">Risk-Based Profile Calculator</h2>
                    <p class="text-stone-600 leading-relaxed">
                        There is no single correct scan configuration. Use the formula below (based on Slide 19) to prioritize segments and determine the recommended sensitivity level. Note the "Fragility Override" rule.
                    </p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 max-w-5xl mx-auto">
                    
                    <!-- Inputs -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                        <h3 class="text-lg font-bold text-stone-800 mb-6 border-b pb-2">Segment Parameters</h3>
                        
                        <!-- Input Group -->
                        <div class="space-y-5">
                            <div>
                                <label class="flex justify-between text-sm font-medium text-stone-700 mb-1">
                                    Data Sensitivity (Weight 3.0)
                                    <span id="disp-data" class="text-amber-600">5</span>
                                </label>
                                <input type="range" min="1" max="10" value="5" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-stone-600" id="in-data" oninput="calculateRisk()">
                                <p class="text-xs text-stone-400">Value of protected assets.</p>
                            </div>

                            <div>
                                <label class="flex justify-between text-sm font-medium text-stone-700 mb-1">
                                    Exposure Level (Weight 2.5)
                                    <span id="disp-exposure" class="text-amber-600">5</span>
                                </label>
                                <input type="range" min="1" max="10" value="5" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-stone-600" id="in-exposure" oninput="calculateRisk()">
                                <p class="text-xs text-stone-400">Likelihood of attack.</p>
                            </div>

                            <div>
                                <label class="flex justify-between text-sm font-medium text-stone-700 mb-1">
                                    Regulatory Req. (Weight 2.0)
                                    <span id="disp-reg" class="text-amber-600">5</span>
                                </label>
                                <input type="range" min="1" max="10" value="5" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-stone-600" id="in-reg" oninput="calculateRisk()">
                                <p class="text-xs text-stone-400">Legal obligation to scan.</p>
                            </div>

                            <div class="bg-red-50 p-3 rounded border border-red-100">
                                <label class="flex justify-between text-sm font-medium text-red-800 mb-1">
                                    Device Fragility (Weight 1.5)
                                    <span id="disp-fragile" class="text-red-600 font-bold">3</span>
                                </label>
                                <input type="range" min="1" max="10" value="3" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-red-500" id="in-fragile" oninput="calculateRisk()">
                                <p class="text-xs text-red-400">Risk of crashing system.</p>
                            </div>

                            <div>
                                <label class="flex justify-between text-sm font-medium text-stone-700 mb-1">
                                    Device Count (Log Scale)
                                    <span id="disp-count" class="text-amber-600">100</span>
                                </label>
                                <input type="range" min="10" max="10000" step="10" value="100" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-stone-600" id="in-count" oninput="calculateRisk()">
                            </div>
                        </div>
                    </div>

                    <!-- Output -->
                    <div class="flex flex-col gap-4">
                        <div class="bg-stone-900 text-white p-8 rounded-xl shadow-lg flex-1 flex flex-col justify-center items-center text-center relative overflow-hidden">
                            <div class="relative z-10">
                                <div class="text-stone-400 text-sm uppercase tracking-widest mb-2">Calculated Risk Score</div>
                                <div id="res-score" class="text-6xl font-bold text-amber-500 mb-2">--</div>
                                <div id="res-level" class="text-xl font-medium text-white mb-6">Adjust parameters</div>
                                
                                <div class="h-px w-full bg-stone-700 my-4"></div>
                                
                                <div class="text-stone-400 text-xs uppercase tracking-widest mb-1">Recommended Sensitivity</div>
                                <div id="res-rec" class="text-2xl font-bold text-white">--</div>
                            </div>
                            <!-- Background accent -->
                            <div class="absolute -bottom-10 -right-10 w-40 h-40 bg-amber-500/10 rounded-full blur-2xl"></div>
                        </div>

                        <div id="fragility-warning" class="hidden bg-red-100 border-l-4 border-red-500 p-4 rounded shadow-sm animate-pulse">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <span class="text-red-500 text-2xl">⚠</span>
                                </div>
                                <div class="ml-3">
                                    <p class="text-sm text-red-700 font-bold">Fragility Override Active</p>
                                    <p class="text-xs text-red-600">Fragility is ≥ 7. Sensitivity is capped at LOW (Safe Checks Only) regardless of risk score to prevent system failure.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- TAB 4: GLOSSARY -->
            <section id="tab-glossary" class="tab-content hidden space-y-6 animate-fade-in">
                 <div class="max-w-4xl mx-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-stone-800">Glossary & Key Terms</h2>
                        <input type="text" id="glossary-search" placeholder="Search terms..." class="border border-stone-300 rounded px-3 py-2 text-sm focus:outline-none focus:border-amber-500 w-64">
                    </div>
                    <div class="bg-white rounded-xl shadow-sm border border-stone-200 overflow-hidden">
                        <table class="min-w-full divide-y divide-stone-200">
                            <thead class="bg-stone-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-stone-500 uppercase tracking-wider">Abbreviation</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-stone-500 uppercase tracking-wider">Full Term</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-stone-200" id="glossary-body">
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="mt-8">
                        <h3 class="text-lg font-bold text-stone-800 mb-4">External References</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm" id="reference-links">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                 </div>
            </section>

        </main>

        <!-- Footer -->
        <footer class="bg-stone-100 border-t border-stone-200 p-4 text-center text-xs text-stone-500">
            <p>© Cyber.SoHo — Educational purposes only. Always verify your target list against written authorization.</p>
        </footer>

    </div>

    <!-- JavaScript Implementation -->
    <script>
        // --- DATA STORAGE ---

        // Glossary Data (Slide 24)
        const glossaryData = [
            { abbr: "ACL", term: "Access Control List" },
            { abbr: "ASV", term: "Approved Scanning Vendor" },
            { abbr: "CFAA", term: "Computer Fraud and Abuse Act" },
            { abbr: "CVE", term: "Common Vulnerabilities and Exposures" },
            { abbr: "CVSS", term: "Common Vulnerability Scoring System" },
            { abbr: "DMZ", term: "Demilitarized Zone" },
            { abbr: "ICS", term: "Industrial Control Systems" },
            { abbr: "NIST", term: "National Institute of Standards and Technology" },
            { abbr: "OT", term: "Operational Technology" },
            { abbr: "OWASP", term: "Open Web Application Security Project" },
            { abbr: "PCI DSS", term: "Payment Card Industry Data Security Standard" },
            { abbr: "SCADA", term: "Supervisory Control and Data Acquisition" },
            { abbr: "VLAN", term: "Virtual Local Area Network" },
            { abbr: "VMDR", term: "Vulnerability Management, Detection, and Response" }
        ];

        // Reference Links (Slide 25)
        const references = [
            { name: "CVE Program", url: "https://www.cve.org/" },
            { name: "NIST Cybersecurity Framework", url: "https://www.nist.gov/cyberframework" },
            { name: "OWASP Top 10", url: "https://owasp.org/www-project-top-ten/" },
            { name: "FIRST — CVSS", url: "https://www.first.org/cvss/" },
            { name: "Shodan", url: "https://www.shodan.io/" }
        ];

        // Building Block Info (Slide 3-9)
        const buildingBlocks = [
            { 
                title: "Target Scope", 
                desc: "Defines WHICH machines to scan. Can be single IPs, ranges, CIDR blocks, or hostnames.", 
                extra: "Golden Rule: Always verify target list against written authorization. Unauthorized scanning is illegal." 
            },
            { 
                title: "Port Range", 
                desc: "Determines how many 'doors' are checked. Options range from Top 100 common services to all 65,535 TCP ports.", 
                extra: "Strategy: Internet-facing = Full. Internal Printers = Top 1000." 
            },
            { 
                title: "Vulnerability Checks", 
                desc: "Specific tests (Plugins) run against targets. Mapped to CVE entries.", 
                extra: "Best Practice: Disable irrelevant families (e.g., no Linux checks on Windows servers)." 
            },
            { 
                title: "Credentials", 
                desc: "Logging in (Authenticated) vs. Staying outside (Unauthenticated).", 
                extra: "Credentialed scans find 5-50x more vulnerabilities." 
            },
            { 
                title: "Speed & Throttling", 
                desc: "Controls scan aggressiveness (packets/sec) and concurrent hosts.", 
                extra: "Low for fragile systems (POS), High for robust dev environments." 
            },
            { 
                title: "Compliance Templates", 
                desc: "Checks against regulatory frameworks like PCI DSS, NIST, or CIS Benchmarks.", 
                extra: "Often required by law or industry standards." 
            }
        ];

        // Zone Profiles (Slide 18)
        const zoneProfiles = {
            dmz: {
                title: "DMZ / Public-Facing",
                color: "text-red-600 border-red-500",
                bg: "bg-red-50",
                sensitivity: "High + Web App Plugins",
                perspective: "Internal (Sensor) AND External",
                focus: "OWASP Top 10, Web vulnerabilities",
                desc: "The most exposed zone. Requires aggressive scanning from both sides to simulate external attackers and internal breaches."
            },
            lan: {
                title: "Corporate LAN",
                color: "text-blue-600 border-blue-500",
                bg: "bg-blue-50",
                sensitivity: "Medium",
                perspective: "Internal Credentialed",
                focus: "Missing patches, outdated software, local firewalls",
                desc: "Where users operate. High risk of phishing/malware. Credentialed scans are essential to see installed software versions."
            },
            server: {
                title: "Server VLAN / Data Center",
                color: "text-amber-600 border-amber-500",
                bg: "bg-amber-50",
                sensitivity: "High (Coordinated)",
                perspective: "Internal",
                focus: "Default credentials, Database plugins",
                desc: "Critical infrastructure. High sensitivity is needed, but schedule carefully to avoid impacting backups or batch jobs."
            },
            ot: {
                title: "OT / SCADA",
                color: "text-green-600 border-green-500",
                bg: "bg-green-50",
                sensitivity: "LOW (Safe Checks Only)",
                perspective: "Internal Passive",
                focus: "ICS-CERT advisories, known exploits",
                desc: "FRAGILE. Never run intrusive plugins. Industrial equipment can crash easily. Prefer passive monitoring."
            }
        };

        // --- CHART INSTANCES ---
        let portChartInst = null;
        let credChartInst = null;

        // --- CORE FUNCTIONS ---

        function init() {
            renderGlossary();
            renderReferences();
            initPortChart();
            initCredChart();
            
            // Setup Search Listener
            document.getElementById('glossary-search').addEventListener('keyup', (e) => {
                const term = e.target.value.toLowerCase();
                const rows = document.querySelectorAll('#glossary-body tr');
                rows.forEach(row => {
                    const text = row.innerText.toLowerCase();
                    row.style.display = text.includes(term) ? '' : 'none';
                });
            });
        }

        // Tab Switching Logic
        function switchTab(tabId) {
            // Hide all contents
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            // Show selected
            document.getElementById(`tab-${tabId}`).classList.remove('hidden');
            
            // Update buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('border-amber-500', 'text-amber-700', 'bg-white');
                btn.classList.add('border-transparent', 'text-stone-500');
            });
            const activeBtn = document.getElementById(`tab-btn-${tabId}`);
            activeBtn.classList.add('border-amber-500', 'text-amber-700', 'bg-white');
            activeBtn.classList.remove('border-transparent', 'text-stone-500');
        }

        // --- SECTION 1: PROFILE BUILDER LOGIC ---

        function showBlockInfo(index) {
            const data = buildingBlocks[index];
            const panel = document.getElementById('block-detail-panel');
            panel.classList.remove('hidden');
            document.getElementById('block-title').innerText = data.title;
            document.getElementById('block-desc').innerText = data.desc;
            document.getElementById('block-extra').innerText = data.extra;
            
            // Simple animation reset
            panel.classList.remove('animate-pulse');
            void panel.offsetWidth; 
            panel.classList.add('animate-pulse');
            setTimeout(() => panel.classList.remove('animate-pulse'), 500);
        }

        function initPortChart() {
            const ctx = document.getElementById('portChart').getContext('2d');
            portChartInst = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Top 100', 'Top 1000', 'Full Scan'],
                    datasets: [{
                        label: 'Ports Covered',
                        data: [100, 1000, 65535],
                        backgroundColor: ['#d6d3d1', '#78716c', '#f59e0b'],
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.raw.toLocaleString() + ' Ports';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            type: 'logarithmic',
                            title: { display: true, text: 'Number of Ports (Log Scale)' }
                        }
                    }
                }
            });
        }

        let isCredView = false; // False = findings count, True = depth
        function initCredChart() {
            const ctx = document.getElementById('credChart').getContext('2d');
            credChartInst = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Non-Credentialed', 'Credentialed'],
                    datasets: [{
                        label: 'Relative Findings Volume',
                        data: [5, 100], // abstract representation of 5-50x
                        backgroundColor: ['#a8a29e', '#0ea5e9'],
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        title: { display: true, text: 'Vulnerabilities Detected (Relative Scale)' }
                    },
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
        }

        function toggleCredChart() {
            isCredView = !isCredView;
            if (isCredView) {
                // Show False Positives comparison
                credChartInst.data.datasets[0].data = [80, 10];
                credChartInst.data.datasets[0].label = 'False Positive Rate (%)';
                credChartInst.data.datasets[0].backgroundColor = ['#ef4444', '#22c55e'];
                credChartInst.options.plugins.title.text = 'False Positive Rate (Lower is Better)';
            } else {
                // Show Findings comparison
                credChartInst.data.datasets[0].data = [5, 100];
                credChartInst.data.datasets[0].label = 'Relative Findings Volume';
                credChartInst.data.datasets[0].backgroundColor = ['#a8a29e', '#0ea5e9'];
                credChartInst.options.plugins.title.text = 'Vulnerabilities Detected (Higher is Better)';
            }
            credChartInst.update();
        }

        // --- SECTION 2: SENSITIVITY & SEGMENTS LOGIC ---

        function updateSensitivityUI() {
            const val = document.getElementById('sensitivity-slider').value;
            const findingsEl = document.getElementById('val-findings');
            const fpEl = document.getElementById('val-fp');
            const impactEl = document.getElementById('val-impact');
            const descEl = document.getElementById('sens-desc');

            if (val == "1") { // LOW
                findingsEl.innerText = "Fewer";
                fpEl.innerText = "Very Low";
                impactEl.innerText = "Minimal";
                descEl.innerText = "Low Sensitivity: Misses threats (False Negatives) but safe for fragile systems. Good for OT/Medical.";
            } else if (val == "2") { // MED
                findingsEl.innerText = "Balanced";
                fpEl.innerText = "Manageable";
                impactEl.innerText = "Moderate";
                descEl.innerText = "The Sweet Spot: Catches genuine dangers without flooding reports or crashing services. Standard for LAN.";
            } else { // HIGH
                findingsEl.innerText = "Many";
                fpEl.innerText = "High";
                impactEl.innerText = "Significant";
                descEl.innerText = "High Sensitivity (Paranoid): Catches edge cases but generates noise. Use for Dev/Staging or critical DMZ.";
            }
        }

        function selectZone(zoneKey) {
            const zone = zoneProfiles[zoneKey];
            const card = document.getElementById('zone-info-card');
            
            // Rebuild Card Content
            card.innerHTML = `
                <div class="border-b-4 ${zone.color.split(' ')[1]} pb-4 mb-4">
                    <h3 class="text-2xl font-bold text-stone-800">${zone.title}</h3>
                    <div class="mt-2 inline-block px-3 py-1 rounded-full text-sm font-bold ${zone.bg} ${zone.color.split(' ')[0]} border border-current">
                        Rec. Sensitivity: ${zone.sensitivity}
                    </div>
                </div>
                <div class="space-y-4 text-left">
                    <div>
                        <span class="text-xs uppercase text-stone-400 font-bold tracking-wider">Perspective</span>
                        <p class="font-medium text-stone-700">${zone.perspective}</p>
                    </div>
                    <div>
                        <span class="text-xs uppercase text-stone-400 font-bold tracking-wider">Key Focus</span>
                        <p class="font-medium text-stone-700">${zone.focus}</p>
                    </div>
                    <div class="bg-stone-50 p-3 rounded text-sm text-stone-600 italic border border-stone-100">
                        "${zone.desc}"
                    </div>
                </div>
            `;
            
            card.classList.add('animate-fade-in');
            setTimeout(() => card.classList.remove('animate-fade-in'), 500);
        }

        // --- SECTION 3: RISK CALCULATOR LOGIC ---

        function calculateRisk() {
            // Get values
            const dataSens = parseFloat(document.getElementById('in-data').value);
            const exposure = parseFloat(document.getElementById('in-exposure').value);
            const reg = parseFloat(document.getElementById('in-reg').value);
            const fragility = parseFloat(document.getElementById('in-fragile').value);
            const count = parseFloat(document.getElementById('in-count').value);

            // Update displays
            document.getElementById('disp-data').innerText = dataSens;
            document.getElementById('disp-exposure').innerText = exposure;
            document.getElementById('disp-reg').innerText = reg;
            document.getElementById('disp-fragile').innerText = fragility;
            document.getElementById('disp-count').innerText = count;

            // Formula: Normalize(Sum of Weighted Factors) * Log10(Count)
            // Note: The prompt implies a normalized calculation. 
            // Max weighted sum = (10*3) + (10*2.5) + (10*1.5) + (10*2) = 30+25+15+20 = 90.
            // Let's treat the sum as the base score (0-90) and scale slightly by device count logic if implied, 
            // or just use the sum as the primary driver. Slide 19 says "Normalize(...) * scale factor".
            
            let rawSum = (dataSens * 3.0) + (exposure * 2.5) + (fragility * 1.5) + (reg * 2.0);
            
            // Log10(10)=1, Log10(100)=2, Log10(1000)=3. 
            // Let's create a multiplier. 
            let scaleFactor = Math.log10(count); 
            
            // To keep score 0-100 roughly:
            // Max Raw = 90. Max Scale (10k devices) = 4. 90*4 = 360 (Too high).
            // Let's normalize rawSum to 0-10 (rawSum / 9). 
            // Then multiply by scaleFactor * constant to fit 0-100.
            // Let's try: (RawSum / 90) * 100 is base risk. Then adjust small amount for count.
            // Actually, let's stick to a simpler interpretation for the UI:
            // Risk = (RawSum / 90) * 100.
            
            let score = (rawSum / 90) * 100;
            
            // Fragility Override
            let override = false;
            if (fragility >= 7) {
                override = true;
                document.getElementById('fragility-warning').classList.remove('hidden');
            } else {
                document.getElementById('fragility-warning').classList.add('hidden');
            }

            // Determine Recommendation
            let recText = "";
            let levelText = "";
            
            if (override) {
                recText = "LOW (Safe Checks)";
                levelText = "High Risk but FRAGILE";
            } else {
                if (score >= 75) {
                    recText = "HIGH (Paranoid Mode)";
                    levelText = "Critical Risk";
                } else if (score >= 50) {
                    recText = "MEDIUM-HIGH";
                    levelText = "Significant Risk";
                } else if (score >= 30) {
                    recText = "MEDIUM";
                    levelText = "Moderate Risk";
                } else {
                    recText = "LOW-MEDIUM";
                    levelText = "Low Risk";
                }
            }

            // Update UI
            const scoreEl = document.getElementById('res-score');
            scoreEl.innerText = Math.round(score);
            document.getElementById('res-level').innerText = levelText;
            document.getElementById('res-rec').innerText = recText;
            
            // Colorize Score
            if(score > 75) scoreEl.className = "text-6xl font-bold text-red-500 mb-2";
            else if(score > 50) scoreEl.className = "text-6xl font-bold text-amber-500 mb-2";
            else scoreEl.className = "text-6xl font-bold text-green-500 mb-2";
        }

        // --- RENDER HELPERS ---

        function renderGlossary() {
            const tbody = document.getElementById('glossary-body');
            tbody.innerHTML = glossaryData.map(item => `
                <tr class="hover:bg-stone-50 transition-colors">
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-bold text-stone-900">${item.abbr}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-stone-600">${item.term}</td>
                </tr>
            `).join('');
        }

        function renderReferences() {
            const container = document.getElementById('reference-links');
            container.innerHTML = references.map(link => `
                <a href="${link.url}" target="_blank" class="flex items-center p-3 rounded border border-stone-200 hover:bg-amber-50 hover:border-amber-300 transition-colors group">
                    <span class="text-amber-500 mr-2 group-hover:translate-x-1 transition-transform">→</span>
                    <span class="text-stone-700 font-medium">${link.name}</span>
                </a>
            `).join('');
        }

        // Init
        window.addEventListener('load', () => {
            init();
            calculateRisk(); // Run once to set initial state
        });

    </script>
</body>
</html>




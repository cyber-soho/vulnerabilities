<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vulnerability Management Policy & Compliance Explorer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Chart Container Styling as per requirements */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px; /* Constraint width for readability */
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        
        /* Custom scrollbar for cleaner look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .tab-active {
            border-bottom: 2px solid #4f46e5;
            color: #4f46e5;
            font-weight: 600;
        }
        .tab-inactive {
            color: #6b7280;
        }
        .tab-inactive:hover {
            color: #374151;
        }
    </style>
    <!-- Chosen Palette: Warm Neutrals with Professional Accents -->
    <!-- Background: #fafaf9 (Stone-50) -->
    <!-- Text: #1c1917 (Stone-900) -->
    <!-- Accents: Indigo (Primary), Emerald (Success), Amber (Warning), Rose (Critical) -->
</head>
<body class="bg-stone-50 text-stone-800 font-sans antialiased selection:bg-indigo-100 selection:text-indigo-900">

    <!-- Application Structure Plan:
         1. Hero Section: Hook ("Rules without enforcement...") and high-level definition.
         2. Interactive Policy Framework: A grid exploring the 8 Core Components.
         3. Risk & SLA Calculator: Interactive tool to map CVSS to SLA, visualizing urgency.
         4. Compliance Hub: Tabbed interface comparing PCI-DSS, HIPAA, and GDPR side-by-side.
         5. Executive Dashboard: Mock-up of the "Reporting & Metrics" slide to show what success looks like.
         6. Resources & Footer.
    -->

    <!-- Visualization & Content Choices:
         1. Policy Components: Interactive Cards -> Goal: Inform/Organize -> Click to reveal deep dive content from slides 4-8.
         2. SLA Visualizer: Bar Chart -> Goal: Compare -> Visually contrasts the tight deadlines of Critical vs Low severity.
         3. Role Filter: Dropdown/Text -> Goal: Inform -> Users select a role to see responsibilities (Slide 6).
         4. Compliance Comparison: Tabbed Content + Radar Chart -> Goal: Compare -> Highlights differences in scope/fines.
         5. Metrics Dashboard: Line/Doughnut Charts -> Goal: Inform -> Visualizes the abstract metrics (MTTR, Coverage) defined in Slide 9.
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. Unicode icons and Chart.js Canvas used only. -->

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-white/90 backdrop-blur-md shadow-sm border-b border-stone-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl mr-2">üõ°Ô∏è</span>
                    <h1 class="font-bold text-xl tracking-tight text-stone-900">Cyber.SoHo <span class="font-normal text-stone-500">| VM Explorer</span></h1>
                </div>
                <div class="hidden md:flex items-center space-x-8">
                    <button onclick="scrollToSection('policy')" class="text-sm font-medium hover:text-indigo-600 transition-colors">Policy Framework</button>
                    <button onclick="scrollToSection('slas')" class="text-sm font-medium hover:text-indigo-600 transition-colors">Risk & SLAs</button>
                    <button onclick="scrollToSection('compliance')" class="text-sm font-medium hover:text-indigo-600 transition-colors">Compliance</button>
                    <button onclick="scrollToSection('dashboard')" class="text-sm font-medium hover:text-indigo-600 transition-colors">Metrics</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="bg-white border-b border-stone-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 sm:py-24 text-center">
            <h2 class="text-4xl sm:text-5xl font-extrabold text-stone-900 tracking-tight mb-4">
                Vulnerability Management Policy
            </h2>
            <p class="text-xl text-stone-500 max-w-3xl mx-auto mb-8">
                "Rules without enforcement are suggestions. In cybersecurity, suggestions get you breached."
            </p>
            <div class="flex flex-wrap justify-center gap-4">
                <div class="bg-stone-100 px-4 py-2 rounded-lg border border-stone-200">
                    <span class="block text-2xl font-bold text-indigo-600">25k+</span>
                    <span class="text-sm text-stone-600">New CVEs / Year</span>
                </div>
                <div class="bg-stone-100 px-4 py-2 rounded-lg border border-stone-200">
                    <span class="block text-2xl font-bold text-indigo-600">3</span>
                    <span class="text-sm text-stone-600">Major Regulations</span>
                </div>
                <div class="bg-stone-100 px-4 py-2 rounded-lg border border-stone-200">
                    <span class="block text-2xl font-bold text-indigo-600">8</span>
                    <span class="text-sm text-stone-600">Core Components</span>
                </div>
            </div>
            <p class="mt-8 text-sm text-stone-400">Based on Day 5 Lecture Material</p>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-20">

        <!-- SECTION 1: Policy Components -->
        <section id="policy" class="scroll-mt-24">
            <div class="mb-8 border-l-4 border-indigo-500 pl-4">
                <h3 class="text-2xl font-bold text-stone-900">The 8 Core Components</h3>
                <p class="mt-2 text-stone-600">
                    A VM policy transforms ad-hoc guesswork into a structured process. It answers five fundamental questions: 
                    <strong>What? How bad? How fast? Who? What if?</strong> Explore the components below to understand the operational blueprint.
                </p>
            </div>

            <!-- Grid of Interactive Cards -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6" id="component-grid">
                <!-- JS will populate this -->
            </div>

            <!-- Detail View Area (Dynamic) -->
            <div id="component-detail" class="mt-8 bg-white rounded-xl shadow-lg border border-stone-200 p-6 hidden transition-all duration-300">
                <div class="flex items-start justify-between">
                    <div>
                        <h4 id="detail-title" class="text-xl font-bold text-stone-900"></h4>
                        <span id="detail-tag" class="inline-block mt-1 px-2 py-0.5 rounded text-xs font-semibold bg-indigo-100 text-indigo-800"></span>
                    </div>
                    <button onclick="closeDetail()" class="text-stone-400 hover:text-stone-600 text-2xl">&times;</button>
                </div>
                <div id="detail-content" class="mt-4 text-stone-600 prose prose-stone max-w-none">
                    <!-- Content injected here -->
                </div>
            </div>
        </section>

        <!-- SECTION 2: Roles & Responsibilities Interaction -->
        <section class="bg-indigo-50 rounded-2xl p-8 border border-indigo-100">
            <div class="md:flex md:items-center md:justify-between mb-6">
                <div>
                    <h3 class="text-2xl font-bold text-stone-900">Who Owns What?</h3>
                    <p class="text-stone-600 mt-1">Select a role to see their specific responsibilities in the VM cycle.</p>
                </div>
                <div class="mt-4 md:mt-0">
                    <select id="role-selector" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 bg-white py-2 px-4 text-stone-900" onchange="updateRoleDisplay()">
                        <option value="soc">SOC (Security Ops Center)</option>
                        <option value="it">IT Operations</option>
                        <option value="app">Application Owners</option>
                        <option value="mgmt">Management / CISO</option>
                        <option value="compliance">Compliance Team</option>
                    </select>
                </div>
            </div>
            <div id="role-display" class="bg-white rounded-xl p-6 shadow-sm border border-indigo-100 min-h-[120px] flex items-center">
                <!-- Content injected via JS -->
            </div>
        </section>

        <!-- SECTION 3: Risk Classification & SLAs -->
        <section id="slas" class="scroll-mt-24">
            <div class="mb-8 border-l-4 border-amber-500 pl-4">
                <h3 class="text-2xl font-bold text-stone-900">Risk Classification & Remediation SLAs</h3>
                <p class="mt-2 text-stone-600">
                    Not all vulnerabilities are equal. We map CVSS scores to severity labels and assign strict deadlines (SLAs). 
                    <strong>Compliance = Days Since Discovery ‚â§ SLA Allowed Days.</strong>
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-start">
                <!-- Interactive Calculator -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                    <h4 class="text-lg font-bold mb-4 text-stone-800">SLA Calculator</h4>
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-stone-700 mb-2">Input CVSS Score (0.0 - 10.0)</label>
                        <input type="number" id="cvss-input" min="0" max="10" step="0.1" value="9.2" 
                               class="w-full p-3 border border-stone-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-lg font-mono"
                               oninput="calculateSLA()">
                        <input type="range" id="cvss-slider" min="0" max="10" step="0.1" value="9.2" 
                               class="w-full mt-2 accent-amber-500" oninput="syncInputs(this.value)">
                    </div>

                    <div id="sla-result" class="bg-stone-50 rounded-lg p-4 border border-stone-200 text-center transition-colors duration-300">
                        <p class="text-sm text-stone-500 uppercase tracking-wide font-semibold">Severity</p>
                        <div id="severity-badge" class="text-3xl font-bold text-red-600 my-1">CRITICAL</div>
                        <p class="text-sm text-stone-500 mt-4 uppercase tracking-wide font-semibold">Remediation SLA</p>
                        <div id="sla-days" class="text-4xl font-extrabold text-stone-900">24-48 Hours</div>
                    </div>
                </div>

                <!-- Visualization -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                    <h4 class="text-lg font-bold mb-4 text-stone-800">SLA Timeline Visualization</h4>
                    <p class="text-sm text-stone-500 mb-4">Comparison of allowed remediation windows by severity.</p>
                    <div class="chart-container">
                        <canvas id="slaChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Exception Process Diagram -->
            <div class="mt-8 bg-stone-50 p-6 rounded-xl border border-stone-200">
                <h4 class="text-lg font-bold mb-4 text-stone-800">Exceptions: When Patching Isn't Possible</h4>
                <div class="flex flex-col md:flex-row justify-between items-center gap-4 text-sm">
                    <div class="flex-1 bg-white p-3 rounded shadow-sm border-l-4 border-blue-500">1. Request (Owner)</div>
                    <div class="text-stone-400">‚Üí</div>
                    <div class="flex-1 bg-white p-3 rounded shadow-sm border-l-4 border-blue-500">2. Compensating Controls</div>
                    <div class="text-stone-400">‚Üí</div>
                    <div class="flex-1 bg-white p-3 rounded shadow-sm border-l-4 border-purple-500">3. CISO Approval</div>
                    <div class="text-stone-400">‚Üí</div>
                    <div class="flex-1 bg-white p-3 rounded shadow-sm border-l-4 border-amber-500">4. Set Expiration</div>
                    <div class="text-stone-400">‚Ü∫</div>
                    <div class="flex-1 bg-white p-3 rounded shadow-sm border-l-4 border-stone-500">5. Re-Assessment</div>
                </div>
            </div>
        </section>

        <!-- SECTION 4: Compliance Landscape -->
        <section id="compliance" class="scroll-mt-24">
            <div class="mb-8 border-l-4 border-emerald-500 pl-4">
                <h3 class="text-2xl font-bold text-stone-900">Regulatory Landscape</h3>
                <p class="mt-2 text-stone-600">
                    Compliance is the floor, not the ceiling. We must adhere to the strictest regulation that applies.
                    Compare the "Big Three" frameworks below.
                </p>
            </div>

            <!-- Tabbed Interface -->
            <div class="bg-white rounded-xl shadow-lg border border-stone-200 overflow-hidden">
                <div class="flex border-b border-stone-200 bg-stone-50">
                    <button class="flex-1 py-4 text-center text-sm font-medium tab-active transition-colors" onclick="switchTab('pci', this)">PCI-DSS</button>
                    <button class="flex-1 py-4 text-center text-sm font-medium tab-inactive transition-colors" onclick="switchTab('hipaa', this)">HIPAA</button>
                    <button class="flex-1 py-4 text-center text-sm font-medium tab-inactive transition-colors" onclick="switchTab('gdpr', this)">GDPR</button>
                </div>

                <div class="p-6 md:p-8">
                    <!-- PCI Content -->
                    <div id="tab-pci" class="tab-content block">
                        <div class="flex items-center mb-4">
                            <span class="text-3xl mr-3">üí≥</span>
                            <h4 class="text-2xl font-bold text-stone-900">PCI-DSS (Payment Card Industry)</h4>
                        </div>
                        <p class="text-stone-600 mb-6 italic">"Guarding your wallet"</p>
                        
                        <div class="grid md:grid-cols-2 gap-8">
                            <div class="space-y-4">
                                <div class="bg-emerald-50 p-4 rounded-lg border border-emerald-100">
                                    <h5 class="font-bold text-emerald-800">Critical Mandates</h5>
                                    <ul class="list-disc list-inside mt-2 text-sm text-emerald-900 space-y-1">
                                        <li>Patch Criticals within <strong>1 month</strong> (Req 6.3.3)</li>
                                        <li>Quarterly Internal Scans (Req 11.3.1)</li>
                                        <li>Quarterly External ASV Scans (Req 11.3.2)</li>
                                    </ul>
                                </div>
                                <div class="bg-red-50 p-4 rounded-lg border border-red-100">
                                    <h5 class="font-bold text-red-800">Consequences</h5>
                                    <p class="text-sm text-red-900 mt-2">$5k - $100k/month fines. Revocation of card processing privileges (Business Ending).</p>
                                </div>
                            </div>
                            <div>
                                <h5 class="font-bold text-stone-800 mb-2">The Cycle</h5>
                                <div class="bg-stone-900 text-stone-100 p-4 rounded-lg font-mono text-sm">
                                    <p>1. SCAN (Internal/External)</p>
                                    <p class="pl-4 text-stone-400">‚¨á</p>
                                    <p>2. FIX (High/Criticals)</p>
                                    <p class="pl-4 text-stone-400">‚¨á</p>
                                    <p>3. RESCAN (Verify Fixes)</p>
                                    <p class="pl-4 text-stone-400">‚¨á</p>
                                    <p>4. PROVE (Audit Evidence)</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- HIPAA Content -->
                    <div id="tab-hipaa" class="tab-content hidden">
                        <div class="flex items-center mb-4">
                            <span class="text-3xl mr-3">üè•</span>
                            <h4 class="text-2xl font-bold text-stone-900">HIPAA (Health Insurance Portability & Accountability)</h4>
                        </div>
                        <p class="text-stone-600 mb-6 italic">"Guarding your medical chart"</p>
                        
                        <div class="grid md:grid-cols-2 gap-8">
                            <div class="space-y-4">
                                <div class="bg-blue-50 p-4 rounded-lg border border-blue-100">
                                    <h5 class="font-bold text-blue-800">Core Principles</h5>
                                    <ul class="list-disc list-inside mt-2 text-sm text-blue-900 space-y-1">
                                        <li><strong>Risk Assessment:</strong> Regular & Documented.</li>
                                        <li><strong>ePHI Elevation:</strong> Vulns on health systems = Higher Risk.</li>
                                        <li><strong>Reasonable Standard:</strong> No hard deadline, but delays are penalized.</li>
                                    </ul>
                                </div>
                                <div class="bg-red-50 p-4 rounded-lg border border-red-100">
                                    <h5 class="font-bold text-red-800">Consequences</h5>
                                    <p class="text-sm text-red-900 mt-2">Up to $1.5M/year per violation category. "Wall of Shame" public listing for breaches > 500 records.</p>
                                </div>
                            </div>
                            <div>
                                <h5 class="font-bold text-stone-800 mb-2">Risk Formula</h5>
                                <div class="bg-stone-100 p-4 rounded-lg text-center border border-stone-200">
                                    <span class="block text-stone-500 text-xs uppercase">Risk Calculation</span>
                                    <span class="text-lg font-bold">Likelihood (CVSS)</span>
                                    <span class="text-stone-400 mx-2">√ó</span>
                                    <span class="text-lg font-bold">Impact (ePHI)</span>
                                </div>
                                <p class="mt-4 text-sm text-stone-600"><strong>Note:</strong> 6 Year retention required for all documentation.</p>
                            </div>
                        </div>
                    </div>

                    <!-- GDPR Content -->
                    <div id="tab-gdpr" class="tab-content hidden">
                        <div class="flex items-center mb-4">
                            <span class="text-3xl mr-3">üá™üá∫</span>
                            <h4 class="text-2xl font-bold text-stone-900">GDPR (General Data Protection Regulation)</h4>
                        </div>
                        <p class="text-stone-600 mb-6 italic">"Guarding your digital identity" (Global Scope)</p>
                        
                        <div class="grid md:grid-cols-2 gap-8">
                            <div class="space-y-4">
                                <div class="bg-purple-50 p-4 rounded-lg border border-purple-100">
                                    <h5 class="font-bold text-purple-800">Key Articles</h5>
                                    <ul class="list-disc list-inside mt-2 text-sm text-purple-900 space-y-1">
                                        <li><strong>Art 32:</strong> Mandates regular testing (scanning/pentesting).</li>
                                        <li><strong>Art 33:</strong> 72-Hour Breach Notification clock.</li>
                                        <li><strong>Scope:</strong> Any EU resident data, regardless of company location.</li>
                                    </ul>
                                </div>
                                <div class="bg-red-50 p-4 rounded-lg border border-red-100">
                                    <h5 class="font-bold text-red-800">Massive Fines</h5>
                                    <p class="text-sm text-red-900 mt-2">Up to <strong>‚Ç¨20 Million</strong> or <strong>4% of Global Turnover</strong>.</p>
                                </div>
                            </div>
                            <div>
                                <h5 class="font-bold text-stone-800 mb-2">The 72-Hour Clock</h5>
                                <div class="relative pt-1">
                                    <div class="flex mb-2 items-center justify-between">
                                        <div>
                                            <span class="text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-red-600 bg-red-200">
                                                Breach Detected
                                            </span>
                                        </div>
                                        <div class="text-right">
                                            <span class="text-xs font-semibold inline-block text-red-600">
                                                Notify DPA
                                            </span>
                                        </div>
                                    </div>
                                    <div class="overflow-hidden h-2 mb-4 text-xs flex rounded bg-stone-200">
                                        <div style="width: 100%" class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-red-500 animate-pulse"></div>
                                    </div>
                                    <p class="text-xs text-stone-500">Timer starts when you become *aware*, not when it happened.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 5: Operational Reporting (Dashboard) -->
        <section id="dashboard" class="scroll-mt-24">
            <div class="mb-8 border-l-4 border-stone-800 pl-4">
                <h3 class="text-2xl font-bold text-stone-900">Reporting & Metrics</h3>
                <p class="mt-2 text-stone-600">
                    You can't manage what you don't measure. An effective VM program tracks specific KPIs to prove efficacy and compliance.
                    Below is a simulation of a healthy VM dashboard.
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- MTTR Chart -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                    <h5 class="font-bold text-stone-700 mb-4 flex justify-between">
                        <span>MTTR (Mean Time To Remediate)</span>
                        <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">Target: &lt;30 Days</span>
                    </h5>
                    <div class="chart-container">
                        <canvas id="mttrChart"></canvas>
                    </div>
                    <p class="text-xs text-stone-400 mt-2 text-center">Lower is better. Shows operational efficiency.</p>
                </div>

                <!-- Compliance Rate Chart -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                    <h5 class="font-bold text-stone-700 mb-4 flex justify-between">
                        <span>SLA Compliance Rate</span>
                        <span class="text-xs bg-amber-100 text-amber-800 px-2 py-1 rounded">Warning: 92%</span>
                    </h5>
                    <div class="chart-container">
                        <canvas id="complianceChart"></canvas>
                    </div>
                    <p class="text-xs text-stone-400 mt-2 text-center">% of vulns fixed within allowed window.</p>
                </div>
            </div>

            <div class="mt-8 bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                <h5 class="font-bold text-stone-700 mb-4">Current Vulnerability Backlog (Open Criticals)</h5>
                <div class="chart-container" style="height: 250px;">
                    <canvas id="backlogChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="bg-stone-900 text-stone-400 py-12">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid md:grid-cols-3 gap-8">
                <div>
                    <h5 class="text-white font-bold text-lg mb-4">Cyber.SoHo</h5>
                    <p class="text-sm mb-4">Vulnerability Management Policy & Compliance</p>
                    <p class="text-xs">¬© 2026 Cyber.SoHo. Educational Use Only.</p>
                </div>
                <div>
                    <h5 class="text-white font-bold text-lg mb-4">Key Takeaway</h5>
                    <p class="text-sm italic border-l-2 border-indigo-500 pl-3">
                        "A well-written VM policy, informed by applicable regulations, is your organization's first and most important line of defense."
                    </p>
                </div>
                <div>
                    <h5 class="text-white font-bold text-lg mb-4">Tools Reference</h5>
                    <ul class="text-sm space-y-2">
                        <li><a href="#" class="hover:text-white transition">Nessus (Tenable)</a> - Commercial</li>
                        <li><a href="#" class="hover:text-white transition">Qualys VMDR</a> - Cloud Platform</li>
                        <li><a href="#" class="hover:text-white transition">Rapid7 InsightVM</a> - Dashboarding</li>
                        <li><a href="#" class="hover:text-white transition">OpenVAS</a> - Open Source</li>
                    </ul>
                </div>
            </div>
        </footer>

    </main>

    <script>
        // DATA & CONTENT CONFIGURATION
        
        // 1. Policy Components Data
        const components = [
            {
                id: 1,
                title: "Scope & Inventory",
                icon: "üó∫Ô∏è",
                summary: "Define every system covered.",
                detail: "<p class='font-bold mb-2'>Rule: If it has an IP address, it belongs in your inventory.</p><ul class='list-disc pl-5 space-y-1'><li>Servers & Workstations</li><li>Network Gear (Routers, Switches)</li><li>IoT Devices</li><li>Cloud/SaaS Assets</li></ul><p class='mt-2'>Tool: <strong>CMDB</strong> (Configuration Management Database).</p>"
            },
            {
                id: 2,
                title: "Roles & Responsibilities",
                icon: "üë•",
                summary: "Who finds it, who fixes it.",
                detail: "Defines ownership to avoid the 'I assumed you were doing it' problem. <br><br><strong>SOC:</strong> Finds.<br><strong>IT Ops:</strong> Fixes.<br><strong>Mgmt:</strong> Accepts Risk."
            },
            {
                id: 3,
                title: "Scanning Frequency",
                icon: "üì°",
                summary: "Cadence of discovery.",
                detail: "Sets the heartbeat of the program.<br><br>Examples:<br>- <strong>Weekly:</strong> Critical Assets<br>- <strong>Monthly:</strong> General IT<br>- <strong>Per-Deployment:</strong> CI/CD Pipeline"
            },
            {
                id: 4,
                title: "Risk Classification",
                icon: "üè∑Ô∏è",
                summary: "CVSS mapping to Severity.",
                detail: "Translates raw math (CVSS 9.8) into business language (CRITICAL).<br>Essential for prioritization so teams don't waste time on trivial issues."
            },
            {
                id: 5,
                title: "Remediation SLAs",
                icon: "‚è±Ô∏è",
                summary: "Deadlines for fixing.",
                detail: "The core enforcement mechanism.<br><strong>Critical:</strong> 24-48 Hours<br><strong>High:</strong> 7 Days<br><strong>Medium:</strong> 30 Days<br><strong>Low:</strong> 90 Days"
            },
            {
                id: 6,
                title: "Exceptions",
                icon: "üìù",
                summary: "Formal risk acceptance.",
                detail: "Process for when a patch cannot be applied (e.g., legacy app breaks).<br>Requires: Justification + Compensating Controls + CISO Approval + Expiration Date."
            },
            {
                id: 7,
                title: "Reporting",
                icon: "üìä",
                summary: "Tracking success.",
                detail: "Metrics driven.<br>- MTTR (Mean Time To Remediate)<br>- SLA Compliance Rate<br>- Scan Coverage %"
            },
            {
                id: 8,
                title: "Review Cadence",
                icon: "üìÖ",
                summary: "Annual updates.",
                detail: "Policies must evolve. Review at least <strong>Annually</strong> or after major infrastructure changes (e.g., moving to AWS)."
            }
        ];

        // 2. Roles Data
        const roleData = {
            soc: {
                title: "Security Operations Center (SOC)",
                desc: "The detectives. They operate the scanners and interpret the results.",
                tasks: ["Run vulnerability scans", "Triage findings (weed out false positives)", "File Jira/ServiceNow tickets"]
            },
            it: {
                title: "IT Operations / SysAdmins",
                desc: "The builders. They own the servers and are responsible for applying changes.",
                tasks: ["Apply patches", "Reboot systems during maintenance windows", "Verify system uptime post-patch"]
            },
            app: {
                title: "Application Owners",
                desc: "The stakeholders. They know how the software works.",
                tasks: ["Approve maintenance windows", "Perform functional testing after patching", "Confirm app integrity"]
            },
            mgmt: {
                title: "Management / CISO",
                desc: "The decision makers.",
                tasks: ["Approve Risk Acceptance (Exceptions)", "Review KPI Dashboards", "Allocate budget for tools"]
            },
            compliance: {
                title: "Compliance Team",
                desc: "The auditors.",
                tasks: ["Map findings to PCI/HIPAA/GDPR", "Prepare evidence for external auditors", "Track policy adherence"]
            }
        };

        // INITIALIZATION
        document.addEventListener('DOMContentLoaded', () => {
            initComponentGrid();
            initCharts();
            updateRoleDisplay(); // Show default role
            calculateSLA(); // Show default SLA
        });

        // FUNCTION: Component Grid Logic
        function initComponentGrid() {
            const grid = document.getElementById('component-grid');
            grid.innerHTML = components.map(c => `
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200 hover:shadow-md hover:border-indigo-300 transition-all cursor-pointer group" onclick="showDetail(${c.id})">
                    <div class="text-3xl mb-3 group-hover:scale-110 transition-transform duration-200">${c.icon}</div>
                    <h4 class="font-bold text-stone-900 mb-1 group-hover:text-indigo-600">${c.title}</h4>
                    <p class="text-sm text-stone-500">${c.summary}</p>
                    <div class="mt-4 text-xs font-semibold text-indigo-500 uppercase tracking-wide opacity-0 group-hover:opacity-100 transition-opacity">Read More &rarr;</div>
                </div>
            `).join('');
        }

        function showDetail(id) {
            const comp = components.find(c => c.id === id);
            const detailBox = document.getElementById('component-detail');
            document.getElementById('detail-title').innerText = comp.title;
            document.getElementById('detail-tag').innerText = `Component #${comp.id}`;
            document.getElementById('detail-content').innerHTML = comp.detail;
            
            detailBox.classList.remove('hidden');
            detailBox.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function closeDetail() {
            document.getElementById('component-detail').classList.add('hidden');
        }

        // FUNCTION: Role Selector Logic
        function updateRoleDisplay() {
            const role = document.getElementById('role-selector').value;
            const data = roleData[role];
            const container = document.getElementById('role-display');
            
            container.innerHTML = `
                <div class="w-full">
                    <h4 class="text-lg font-bold text-indigo-900 mb-1">${data.title}</h4>
                    <p class="text-stone-600 mb-4 italic border-b border-indigo-50 pb-2">${data.desc}</p>
                    <ul class="space-y-2">
                        ${data.tasks.map(t => `<li class="flex items-start text-sm"><span class="mr-2 text-indigo-500">‚úì</span>${t}</li>`).join('')}
                    </ul>
                </div>
            `;
        }

        // FUNCTION: SLA Calculator Logic
        function syncInputs(val) {
            document.getElementById('cvss-input').value = val;
            calculateSLA();
        }

        function calculateSLA() {
            let score = parseFloat(document.getElementById('cvss-input').value);
            if(score > 10) score = 10;
            if(score < 0) score = 0;
            document.getElementById('cvss-slider').value = score;

            let severity = "";
            let sla = "";
            let colorClass = "";
            let bgClass = "";

            if (score >= 9.0) {
                severity = "CRITICAL";
                sla = "24-48 Hours";
                colorClass = "text-red-600";
                bgClass = "bg-red-50 border-red-200";
            } else if (score >= 7.0) {
                severity = "HIGH";
                sla = "7 Days";
                colorClass = "text-orange-600";
                bgClass = "bg-orange-50 border-orange-200";
            } else if (score >= 4.0) {
                severity = "MEDIUM";
                sla = "30 Days";
                colorClass = "text-yellow-600";
                bgClass = "bg-yellow-50 border-yellow-200";
            } else {
                severity = "LOW";
                sla = "90 Days";
                colorClass = "text-green-600";
                bgClass = "bg-green-50 border-green-200";
            }

            const badge = document.getElementById('severity-badge');
            badge.innerText = severity;
            badge.className = `text-3xl font-bold my-1 ${colorClass}`;
            
            document.getElementById('sla-days').innerText = sla;
            
            const resultBox = document.getElementById('sla-result');
            resultBox.className = `rounded-lg p-4 border text-center transition-colors duration-300 ${bgClass}`;
        }

        // FUNCTION: Tab Switching
        function switchTab(tabId, btn) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            // Show selected
            document.getElementById(`tab-${tabId}`).classList.remove('hidden');
            
            // Reset buttons
            const buttons = btn.parentElement.querySelectorAll('button');
            buttons.forEach(b => {
                b.classList.remove('tab-active');
                b.classList.add('tab-inactive');
            });
            
            // Highlight active button
            btn.classList.remove('tab-inactive');
            btn.classList.add('tab-active');
        }

        // FUNCTION: Scroll helper
        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }

        // CHART CONFIGURATIONS
        function initCharts() {
            // Chart 1: SLA Comparison (Bar Chart)
            const slaCtx = document.getElementById('slaChart').getContext('2d');
            new Chart(slaCtx, {
                type: 'bar',
                data: {
                    labels: ['Critical (9-10)', 'High (7-8.9)', 'Medium (4-6.9)', 'Low (0-3.9)'],
                    datasets: [{
                        label: 'Allowed Days to Fix',
                        data: [2, 7, 30, 90], // Using 2 for 48h representation
                        backgroundColor: [
                            'rgba(239, 68, 68, 0.8)', // Red
                            'rgba(249, 115, 22, 0.8)', // Orange
                            'rgba(234, 179, 8, 0.8)', // Yellow
                            'rgba(34, 197, 94, 0.8)'  // Green
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.raw + ' Days allowed';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'Days' }
                        }
                    }
                }
            });

            // Chart 2: MTTR Trend (Line Chart)
            const mttrCtx = document.getElementById('mttrChart').getContext('2d');
            new Chart(mttrCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Avg Remediation Time (Days)',
                        data: [45, 42, 38, 32, 28, 25], // Trending down is good
                        borderColor: '#4f46e5',
                        backgroundColor: 'rgba(79, 70, 229, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        annotation: {
                            annotations: {
                                line1: {
                                    type: 'line',
                                    yMin: 30,
                                    yMax: 30,
                                    borderColor: 'green',
                                    borderWidth: 2,
                                    borderDash: [5, 5],
                                    label: { content: 'SLA Target', enabled: true }
                                }
                            }
                        }
                    },
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });

            // Chart 3: Compliance Rate (Doughnut)
            const compCtx = document.getElementById('complianceChart').getContext('2d');
            new Chart(compCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Compliant (Within SLA)', 'Overdue'],
                    datasets: [{
                        data: [92, 8],
                        backgroundColor: ['#10b981', '#ef4444'],
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });

            // Chart 4: Backlog (Bar)
            const backCtx = document.getElementById('backlogChart').getContext('2d');
            new Chart(backCtx, {
                type: 'bar',
                data: {
                    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                    datasets: [
                        {
                            label: 'Critical',
                            data: [12, 8, 5, 2],
                            backgroundColor: '#ef4444'
                        },
                        {
                            label: 'High',
                            data: [40, 35, 30, 28],
                            backgroundColor: '#f97316'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { stacked: true },
                        y: { stacked: true }
                    }
                }
            });
        }
    </script>
</body>
</html>



